# ğŸ§ª Neural Fusion Lab: Multimodal Agentic Financial System

[![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB?logo=python&logoColor=white)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.x-EE4C2C?logo=pytorch&logoColor=white)](https://pytorch.org/)
[![LangGraph](https://img.shields.io/badge/LangGraph-Orchestration-blue?logo=langchain&logoColor=white)](https://www.langchain.com/)
[![Neo4j](https://img.shields.io/badge/Neo4j-GraphRAG-008CC1?logo=neo4j&logoColor=white)](https://neo4j.com/)
[![Status](https://img.shields.io/badge/Status-Experimental-orange)]()
[![License](https://img.shields.io/badge/License-MIT-green)]()

> **"Exploring the Frontier where Quantitative Finance meets Agentic AI & Multimodal Learning."**

## ğŸ“– About This Lab

**Neural Fusion Lab**ì€ ê¸ˆìœµê³µí•™(Financial Engineering)ê³¼ ìµœì‹  ì¸ê³µì§€ëŠ¥(Modern AI) ê¸°ìˆ ì˜ ìœµí•©ì„ íƒêµ¬í•˜ëŠ” **ì‹¤í—˜ì  ì—°êµ¬ ê³µê°„(Research Sandbox)**ì…ë‹ˆë‹¤.

ì´ ë ˆí¬ì§€í† ë¦¬ëŠ” ì™„ì„±ëœ í”„ë¡œë•íŠ¸ê°€ ì•„ë‹Œ, **"Evolution (ì§„í™”)"**ì„ ëª©í‘œë¡œ í•˜ëŠ” ì¼ë ¨ì˜ **ì‹¤í—˜(Experiments)**ë“¤ì„ ê¸°ë¡í•©ë‹ˆë‹¤. ê¸°ì¡´ì˜ ì •í†µì ì¸ í€€íŠ¸ ëª¨ë¸ì„ ë² ì´ìŠ¤ë¼ì¸(Legacy)ìœ¼ë¡œ ì‚¼ì•„, ìµœì‹  SOTA ì•„í‚¤í…ì²˜ì™€ ìƒˆë¡œìš´ íŒ¨ëŸ¬ë‹¤ì„(Multi-Agent, GraphRAG)ì„ ì ìš©í–ˆì„ ë•Œì˜ íš¨ìš©ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.

---

## ğŸ§ª Research Tracks & Experiments

í˜„ì¬ ë³¸ ì—°êµ¬ì‹¤ì—ì„œëŠ” ì•„ë˜ 3ê°€ì§€ í•µì‹¬ íŠ¸ë™ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì‹¤í—˜ì„ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.

### Track 1. ğŸ§¬ Evolution of Legacy Models (ëª¨ë¸ ê³ ë„í™” ì‹¤í—˜)
> **Hypothesis:** "ë”¥ëŸ¬ë‹ ê¸°ë°˜ì˜ ìƒì„±í˜• ëª¨ë¸ì´ ì „í†µì  í†µê³„ ëª¨ë¸ì˜ ê²½ì§ì„±ì„ ê·¹ë³µí•  ìˆ˜ ìˆëŠ”ê°€?"

* **Legacy (Baseline):** ê¸°ì¡´ì˜ `ARIMA`, `LSTM`, `PPO` ê¸°ë°˜ì˜ ë‹¨ì¼ ëª¨ë¸ ì ‘ê·¼ë²•.
* **Evolution (Experimental):**
    * **TimeSeries Foundation Models:** Chronos, TimeGPT ë“±ì„ í™œìš©í•œ ì œë¡œìƒ· ì˜ˆì¸¡ ì„±ëŠ¥ ê²€ì¦ ì‹¤í—˜.
    * **Deep Hedging:** ê³ ì „ì  ë¸íƒ€ í—·ì§•ì„ ë„˜ì–´ì„  ê°•í™”í•™ìŠµ(RL) ê¸°ë°˜ì˜ ë¹„ì„ í˜• í—·ì§• ì „ëµ ì—°êµ¬.
    * **Neural SDEs:** ë°ì´í„°ë¥¼ í†µí•´ í™•ë¥  ë¯¸ë¶„ë°©ì •ì‹(SDE)ì„ ì§ì ‘ í•™ìŠµí•˜ëŠ” ìƒì„±í˜• ì‹œê³„ì—´ ëª¨ë¸ë§ ì‹¤í—˜.

### Track 2. ğŸ¤– Agentic Workflow (ì—ì´ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì‹¤í—˜)
> **Hypothesis:** "ë‹¨ì¼ LLMì„ ë„˜ì–´ì„  ì „ë¬¸ ì—ì´ì „íŠ¸ í˜‘ì—… ì²´ê³„ê°€ ê¸ˆìœµ ë¶„ì„ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì¼ ìˆ˜ ìˆëŠ”ê°€?"

* **Legacy (Baseline):** ì‚¬ëŒì´ ì§ì ‘ í”¼ì²˜ë¥¼ ê°€ê³µí•˜ê³  ëª¨ë¸ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” ìˆ˜ë™ í”„ë¡œì„¸ìŠ¤.
* **Evolution (Experimental):**
    * **Multi-Agent Systems:** LangGraphë¥¼ í™œìš©í•´ ë°ì´í„° ìˆ˜ì§‘, ì°¨íŠ¸ ë¶„ì„, ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ë¶„ë‹´í•˜ëŠ” ì—ì´ì „íŠ¸ í˜‘ì—… ì‹œìŠ¤í…œ êµ¬ì¶• ë° ìƒíƒœ ê´€ë¦¬(State Management) ì‹¤í—˜.
    * **Auto-Quant:** íˆ¬ì ê°€ì„¤ ì„¤ì •ë¶€í„° ë°±í…ŒìŠ¤íŒ… ì½”ë“œ ì‘ì„±ê¹Œì§€ ìŠ¤ìŠ¤ë¡œ ìˆ˜í–‰í•˜ëŠ” **ììœ¨í˜• í€€íŠ¸(Autonomous Quant)** ì—ì´ì „íŠ¸ í”„ë¡œí† íƒ€ì´í•‘.

### Track 3. ğŸ§  Knowledge-Driven AI (ì§€ì‹ ê¸°ë°˜ ì¶”ë¡  ì‹¤í—˜)
> **Hypothesis:** "ë‹¨ìˆœ ê²€ìƒ‰(Search)ì„ ë„˜ì–´ì„  êµ¬ì¡°ì  ì¶”ë¡ (Reasoning)ì´ ë¦¬ìŠ¤í¬ íƒì§€ì— ìœ íš¨í•œê°€?"

* **Legacy (Baseline):** ë‹¨ìˆœ í…ìŠ¤íŠ¸ ìœ ì‚¬ë„ ê¸°ë°˜ì˜ ê²€ìƒ‰(Simple RAG)ì´ë‚˜ í‚¤ì›Œë“œ ë§¤ì¹­.
* **Evolution (Experimental):**
    * **GraphRAG:** ê¸°ì—… ì§€ë°°êµ¬ì¡°, ê³µê¸‰ë§ ë“± ë³µì¡í•œ ê´€ê³„ë¥¼ **ì§€ì‹ ê·¸ë˜í”„(Knowledge Graph)**ë¡œ ì‹œê°í™”í•˜ê³  2ì°¨ íŒŒê¸‰ íš¨ê³¼ë¥¼ ì¶”ë¡ í•˜ëŠ” ì‹¤í—˜.
    * **Multimodal Analysis:** ì¬ë¬´ì œí‘œ(í…ìŠ¤íŠ¸)ì™€ ì°¨íŠ¸(ì´ë¯¸ì§€)ë¥¼ ë™ì‹œì— ì´í•´í•˜ëŠ” VLM(Vision-Language Model) ê¸°ë°˜ ë¶„ì„ ì‹¤í—˜.

---

## ğŸ”¬ Deep Dive: Active Experiment
**í˜„ì¬ ì¤‘ì ì ìœ¼ë¡œ ì§„í–‰ ì¤‘ì¸ ê°œë³„ ì—°êµ¬ ì£¼ì œì…ë‹ˆë‹¤.**

### [Exp 03] Structural Analysis of Financial Graphs

**Objective:**
ë‹¨ìˆœí•œ ë…¸ë“œ ì—°ê²° ë¶„ì„ì„ ë„˜ì–´, **ê·¸ë˜í”„ ì´ë¡ (Graph Theory)**ê³¼ **ë”¥ëŸ¬ë‹**ì„ ê²°í•©í•˜ì—¬ ê¸ˆìœµ ë„¤íŠ¸ì›Œí¬ ë‚´ì˜ **êµ¬ì¡°ì  ë™í˜•ì„±(Isomorphism)**ì„ íŒë³„í•©ë‹ˆë‹¤. ìê¸ˆ ì„¸íƒ íŒ¨í„´(Money Laundering Ring)ì´ë‚˜ ìˆœí™˜ ì¶œì(Circular Shareholding)ì™€ ê°™ì€ íŠ¹ì´ êµ¬ì¡°ë¥¼ íƒì§€í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

**Theoretical Background:**
* **Graph Isomorphism (GI):** ë‘ ê·¸ë˜í”„ê°€ êµ¬ì¡°ì ìœ¼ë¡œ ë™ì¼í•œì§€ íŒë³„í•˜ëŠ” ë‚œì œ (NP-intermediate).
* **Subgraph Isomorphism:** ê±°ëŒ€ ê·¸ë˜í”„ ë‚´ì—ì„œ íŠ¹ì • íŒ¨í„´ ê·¸ë˜í”„ì™€ ë™í˜•ì¸ ë¶€ë¶„ì§‘í•©ì„ ì°¾ëŠ” ë¬¸ì œ (NP-Complete).

**Methodology:**
1.  **Exact Matching (Hard Approach):**
    * **Algorithm:** VF2 Algorithm (via NetworkX)
    * **Description:** ì—„ë°€í•œ ìˆ˜í•™ì  ì •ì˜(Bijective mapping)ì— ê¸°ë°˜í•˜ì—¬, ì •ì˜ëœ ê¸ˆìœµ ì‚¬ê¸° íŒ¨í„´ê³¼ ì •í™•íˆ ì¼ì¹˜í•˜ëŠ” ë¶€ë¶„ ê·¸ë˜í”„ë¥¼ ì „ìˆ˜ ì¡°ì‚¬.
2.  **Neural Matching (Soft Approach):**
    * **Model:** Graph Isomorphism Network (GIN)
    * **Description:** Weisfeiler-Lehman (WL) Test ê¸°ë°˜ì˜ GNNì„ í™œìš©í•˜ì—¬, ë…¸ì´ì¦ˆê°€ ì„ì¸ ë°ì´í„°ì—ì„œë„ ë‘ ê·¸ë˜í”„ êµ¬ì¡°ì˜ **ìœ ì‚¬ë„(Cosine Similarity)**ë¥¼ ì‚°ì¶œí•˜ì—¬ ìŠ¤ì½”ì–´ë§.

---

## ğŸ—ï¸ Experimental Architecture

ì´ í”„ë¡œì íŠ¸ëŠ” ë‹¨ì¼ ìŠ¤í¬ë¦½íŠ¸ê°€ ì•„ë‹Œ, **Stateful Multi-Agent Architecture**ë¥¼ ì‹¤í—˜ì ìœ¼ë¡œ ì±„íƒí•˜ì—¬ ì—ì´ì „íŠ¸ ê°„ì˜ ë©”ì‹œì§€ íë¦„ì„ ì œì–´í•©ë‹ˆë‹¤.

```mermaid
graph TD
    User((User)) -->|Input Ticker| Supervisor[ğŸ•µï¸ Supervisor Agent]
    
    subgraph "Experimental Agentic Workflow"
        Supervisor -->|Route| Chart[ğŸ“ˆ Chart Analyst\n(GPT-4o Vision)]
        Supervisor -->|Route| Knowledge[ğŸ•¸ï¸ Knowledge Analyst\n(Neo4j GraphRAG)]
        Supervisor -->|Route| Quant[ğŸ§® Quant Analyst\n(Technical Indicators)]
        
        Chart -->|Analysis| Supervisor
        Knowledge -->|Insight| Supervisor
        Quant -->|Metrics| Supervisor
    end
    
    Supervisor -->|Final Decision| User
```

## ğŸ“‚ Lab Structure (ì˜ˆì •)

ì´ ë ˆí¬ì§€í† ë¦¬ëŠ” ì•ˆì •ì ì¸ **í•µì‹¬ ëª¨ë“ˆ(Modules)**ê³¼ ë‹¤ì–‘í•œ ì‹œë„ë¥¼ ìˆ˜í–‰í•˜ëŠ” **ì‹¤í—˜ì‹¤(Experiments)**ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.

```bash
Neural-Fusion-Lab/
â”œâ”€â”€ ğŸ“‚ modules/               # [Stable] ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•µì‹¬ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ agents.py             # LangGraph Nodes & Supervisor Logic
â”‚   â”œâ”€â”€ multimodal.py         # VLM Engine (Image Encoding & Prompting)
â”‚   â”œâ”€â”€ graph_rag.py          # Neo4j Connector & Cypher Query Engine
â”‚   â””â”€â”€ tools.py              # Market Data Fetcher (yfinance wrapper)
â”‚
â”œâ”€â”€ ğŸ“‚ experiments/           # [Sandbox] ì£¼ì œë³„ ì—°êµ¬ ë° ì‹¤í—˜ ì½”ë“œ
â”‚   â”œâ”€â”€ ğŸ§ª exp_01_advanced_rag/        # (Completed) Financial Text Analysis
â”‚   â”œâ”€â”€ ğŸ§ª exp_02_multimodal_chart/    # (Completed) VLM based Technical Analysis
â”‚   â”œâ”€â”€ ğŸ§ª exp_03_structural_analysis/ # (Active) Graph Isomorphism & GIN
â”‚   â””â”€â”€ ğŸ§ª exp_04_neural_sde/          # (Planned) SDE learning from Data
â”‚
â”œâ”€â”€ ğŸ“‚ data/                  # Experiment Data (Generated Charts, CSVs)
â”œâ”€â”€ ğŸ“‚ notebooks/             # EDA & Prototyping Jupyter Notebooks
â”œâ”€â”€ main.py                   # System Entry Point
â”œâ”€â”€ config.yaml               # Experiment Configuration
â””â”€â”€ requirements.txt
```

## ğŸš€ Key Features & Implementation

### 1. ğŸ‘ï¸ Multimodal Technical Analysis (`modules/multimodal.py`)
* **Dynamic Visualization:** `matplotlib`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ì£¼ê°€ ì°¨íŠ¸(SMA, Bollinger Bands í¬í•¨)ë¥¼ ìƒì„±.
* **Vision AI:** ìƒì„±ëœ ì°¨íŠ¸ë¥¼ ì´ë¯¸ì§€ë¡œ ì¸ì½”ë”©í•˜ì—¬ **GPT-4o(VLM)**ì— ì£¼ì…. ë‹¨ìˆœ ìˆ˜ì¹˜ë¡œ íŒŒì•…í•˜ê¸° í˜ë“  ì‹œê°ì  íŒ¨í„´(Head & Shoulders, Wedge ë“±)ì„ ë¶„ì„.

### 2. ğŸ•¸ï¸ Knowledge Graph RAG (`modules/graph_rag.py`)
* **Neo4j Integration:** ê¸°ì—… ê°„ ê´€ê³„(ì§€ë¶„ êµ¬ì¡°, ê³µê¸‰ë§, ê²½ìŸì‚¬)ë¥¼ ì €ì¥í•œ ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™.
* **Supply Chain Risk:** ë‹¨ìˆœ í…ìŠ¤íŠ¸ ë‰´ìŠ¤ê°€ ì•„ë‹Œ, ì—°ê²°ëœ ë…¸ë“œ(Node)ë¥¼ íƒìƒ‰í•˜ì—¬ 2ì°¨, 3ì°¨ íŒŒê¸‰ íš¨ê³¼(Ripple Effect)ë¥¼ ì¶”ë¡ .

### 3. ğŸ¤– Orchestration with LangGraph (`modules/agents.py`)
* **State Management:** `TypedDict`ë¥¼ í™œìš©í•˜ì—¬ ì—ì´ì „íŠ¸ ê°„ ê³µìœ  ë©”ëª¨ë¦¬(Context) ê´€ë¦¬.
* **Router Logic:** ì‘ì—…ì˜ ì¢…ë¥˜ì— ë”°ë¼ ì í•©í•œ ì—ì´ì „íŠ¸ë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ì·¨í•©í•˜ëŠ” ì¤‘ì•™ ì œì–´ êµ¬ì¡°.

## ğŸ’» Getting Started

### Prerequisites
* Python 3.10+
* Neo4j Database (Local or AuraDB)
* OpenAI API Key

### Installation

1.  **Clone the repository**
    ```bash
    git clone [https://github.com/your-username/neural-fusion-lab.git](https://github.com/your-username/neural-fusion-lab.git)
    cd neural-fusion-lab
    ```

2.  **Install dependencies**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Configuration**
    * `.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  API í‚¤ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        ```ini
        OPENAI_API_KEY=sk-proj-...
        NEO4J_URI=bolt://localhost:7687
        NEO4J_USER=neo4j
        NEO4J_PASSWORD=your_password
        ```
    * `config.yaml`ì—ì„œ ëª¨ë¸ ë²„ì „ ë° íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Usage
```bash
```
python main.py ì‹¤í–‰ ì‹œ main.pyì— ì„¤ì •ëœ ì¢…ëª©(ì˜ˆ: NVDA)ì— ëŒ€í•´ ë¶„ì„ì„ ì‹œì‘í•˜ë©°, data/ í´ë”ì— ì°¨íŠ¸ ì´ë¯¸ì§€ê°€ ìƒì„±ë˜ê³  í„°ë¯¸ë„ì— ìµœì¢… ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

## ğŸ”® Future Research (Roadmap)

ì´ í”„ë¡œì íŠ¸ëŠ” ì§€ì†ì ìœ¼ë¡œ ê³ ë„í™”ë  ì˜ˆì •ì…ë‹ˆë‹¤.

* [x] **Phase 1 (Completed):** Multi-Agent System êµ¬ì¶• ë° Multimodal/GraphRAG ì—°ë™.
* [ ] **Phase 2 (In Progress):**
    * **Fine-tuning LLaVA:** ê¸ˆìœµ ì°¨íŠ¸ íŠ¹í™” Vision Model íŒŒì¸íŠœë‹.
    * **Text-to-Cypher:** ìì—°ì–´ ì§ˆì˜ë¥¼ ì •êµí•œ ê·¸ë˜í”„ ì¿¼ë¦¬ë¡œ ë³€í™˜í•˜ëŠ” ëª¨ë¸ í•™ìŠµ.
* [ ] **Phase 3 (Planned):**
    * **Deep Hedging (PPO):** ê°•í™”í•™ìŠµ ê¸°ë°˜ì˜ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™” ëª¨ë“ˆ íƒ‘ì¬.
    * **Auto-Backtest:** ì—ì´ì „íŠ¸ê°€ ì œì•ˆí•œ ì „ëµì„ ì¦‰ì‹œ ê²€ì¦í•˜ëŠ” ë°±í…ŒìŠ¤íŒ… ì—”ì§„ ì—°ë™.

## ğŸ› ï¸ Tech Stack & Tools

* **Core AI:** PyTorch, Stable-Baselines3, Hugging Face Transformers
* **LLM & Agents:** LangChain, LangGraph, LlamaIndex
* **Database & Graph:** Neo4j, Vector DB (Chroma/FAISS)
* **Finance:** yfinance, TA-Lib, QuantLib

---

### ğŸ‘¨â€ğŸ’» Maintainer

* **Jae Yeon Park**
* M.S. in Mathematical Sciences (Financial Mathematics)
* Focus: DRL in Finance, Time-Series Analysis, Agentic AI

---

*Disclaimer: This repository is for research and educational purposes. Not financial advice.*
