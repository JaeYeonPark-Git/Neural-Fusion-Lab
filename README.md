# ğŸ§ª Neural Fusion Lab: Multimodal Agentic Financial System

[![Python](https://img.shields.io/badge/Python-3.10%2B-3776AB?logo=python&logoColor=white)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.x-EE4C2C?logo=pytorch&logoColor=white)](https://pytorch.org/)
[![LangGraph](https://img.shields.io/badge/LangGraph-Orchestration-blue?logo=langchain&logoColor=white)](https://www.langchain.com/)
[![Neo4j](https://img.shields.io/badge/Neo4j-GraphRAG-008CC1?logo=neo4j&logoColor=white)](https://neo4j.com/)
[![Status](https://img.shields.io/badge/Status-Experimental-orange)]()
[![License](https://img.shields.io/badge/License-MIT-green)]()

> **"Exploring the Frontier where Quantitative Finance meets Agentic AI & Multimodal Learning."**

## ğŸ“– About This Lab

**Neural Fusion Lab**ì€ ê¸ˆìœµê³µí•™(Financial Engineering)ê³¼ ìµœì‹  ì¸ê³µì§€ëŠ¥(Modern AI) ê¸°ìˆ ì˜ ìœµí•©ì„ íƒêµ¬í•˜ëŠ” ì‹¤í—˜ì  ì—°êµ¬ ê³µê°„(Sandbox)ì…ë‹ˆë‹¤.

ì´ ë ˆí¬ì§€í† ë¦¬ì˜ ì£¼ëœ ëª©ì ì€ **"Evolution (ì§„í™”)"**ì…ë‹ˆë‹¤.
ê¸°ì¡´ì— ìˆ˜í–‰í–ˆë˜ ì •í†µì ì¸ í€€íŠ¸/ì‹œê³„ì—´ í”„ë¡œì íŠ¸(ARIMA, PPO ë“±)ë¥¼ ê·¸ëŒ€ë¡œ ë‘ì§€ ì•Šê³ , **ìµœì‹  SOTA(State-of-the-Art) ì•„í‚¤í…ì²˜**ì™€ **ìƒˆë¡œìš´ íŒ¨ëŸ¬ë‹¤ì„(Multi-Agent, GraphRAG)**ì„ ì ìš©í•˜ì—¬ í•œ ë‹¨ê³„ ë” ë°œì „ì‹œí‚¤ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

## ğŸ“– Project Overview

**Neural Fusion Lab**ì€ ì •í†µ ê¸ˆìœµê³µí•™(Quantitative Finance)ê³¼ ìµœì‹  ì—ì´ì „íŠ¸ AI(Agentic AI) ê¸°ìˆ ì„ ê²°í•©í•œ ì°¨ì„¸ëŒ€ ê¸ˆìœµ ë¶„ì„ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

ê¸°ì¡´ì˜ ë‹¨ìˆœ ìˆ˜ì¹˜ ë¶„ì„ì„ ë„˜ì–´, **LangGraph** ê¸°ë°˜ì˜ ë©€í‹° ì—ì´ì „íŠ¸ í˜‘ì—… ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ ë³µí•©ì ì¸ ì¶”ë¡ ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

* **Vision Analyst:** ì£¼ê°€ ì°¨íŠ¸ ì´ë¯¸ì§€ë¥¼ ì‹œê°ì ìœ¼ë¡œ ë¶„ì„(VLM)í•˜ì—¬ ê¸°ìˆ ì  íŒ¨í„´ ì‹ë³„.
* **Knowledge Analyst:** ê¸°ì—… ì§€ë°°êµ¬ì¡° ë° ê³µê¸‰ë§ ë°ì´í„°ë¥¼ ì§€ì‹ ê·¸ë˜í”„(Neo4j)ë¡œ íƒìƒ‰í•˜ì—¬ ë¦¬ìŠ¤í¬ ì§„ë‹¨.
* **Quant Analyst:** ì‹œê³„ì—´ ë°ì´í„° ë° ê¸°ìˆ ì  ì§€í‘œ(RSI, MACD ë“±)ë¥¼ ê³„ì‚°.
* **Supervisor:** ìœ„ ëª¨ë“  ì •ë³´ë¥¼ ì¢…í•©í•˜ì—¬ ìµœì ì˜ íˆ¬ìì˜ê²¬(Buy/Sell/Hold) ë„ì¶œ.

## ğŸš€ Research Direction (ì—°êµ¬ ë°©í–¥)

í˜„ì¬ ì´ ì—°êµ¬ì‹¤ì€ ë‹¤ìŒê³¼ ê°™ì€ ë°©í–¥ìœ¼ë¡œ ê¸°ì¡´ ì½”ë“œë“¤ì„ ë¦¬íŒ©í† ë§í•˜ê³  í™•ì¥í•  ê³„íšì…ë‹ˆë‹¤.

### 1. ğŸ§¬ Evolution of Legacy Models (ê¸°ì¡´ ëª¨ë¸ì˜ ê³ ë„í™”)
* **Legacy:** ê¸°ì¡´ì˜ `ARIMA`, `LSTM`, `PPO` ê¸°ë°˜ì˜ ë‹¨ì¼ ëª¨ë¸ ì ‘ê·¼ë²•.
* **Evolution:**
    * **TimeSeries Foundation Models:** Chronos, TimeGPT ë“±ì„ í™œìš©í•œ ì œë¡œìƒ· ì˜ˆì¸¡ ì„±ëŠ¥ ê²€ì¦.
    * **Deep Hedging:** ê³ ì „ì  ë¸íƒ€ í—·ì§•ì„ ë„˜ì–´ì„  ê°•í™”í•™ìŠµ(RL) ê¸°ë°˜ì˜ ë¹„ì„ í˜• í—·ì§• ì „ëµ ì—°êµ¬.
    * **Neural SDEs:** ë°ì´í„°ë¥¼ í†µí•´ ë¯¸ë¶„ë°©ì •ì‹ì„ ì§ì ‘ í•™ìŠµí•˜ëŠ” ìƒì„±í˜• ì‹œê³„ì—´ ëª¨ë¸ë§.

### 2. ğŸ¤– Agentic Workflow (ì—ì´ì „íŠ¸ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš°)
* **Legacy:** ì‚¬ëŒì´ ì§ì ‘ í”¼ì²˜ë¥¼ ê°€ê³µí•˜ê³  ëª¨ë¸ì„ ëŒë¦¬ëŠ” ìˆ˜ë™ í”„ë¡œì„¸ìŠ¤.
* **Evolution:**
    * **Multi-Agent Systems:** ë°ì´í„° ìˆ˜ì§‘, ì°¨íŠ¸ ë¶„ì„, ë¦¬ìŠ¤í¬ ê´€ë¦¬ë¥¼ ê°ê° ë‹´ë‹¹í•˜ëŠ” AI ì—ì´ì „íŠ¸ í˜‘ì—… ì‹œìŠ¤í…œ êµ¬ì¶•.
    * **Auto-Quant:** íˆ¬ì ê°€ì„¤ ì„¤ì •ë¶€í„° ë°±í…ŒìŠ¤íŒ…ê¹Œì§€ ìŠ¤ìŠ¤ë¡œ ìˆ˜í–‰í•˜ëŠ” ììœ¨í˜• í€€íŠ¸ ì—ì´ì „íŠ¸ ì‹¤í—˜.

### 3. ğŸ§  Knowledge-Driven AI (ì§€ì‹ ê¸°ë°˜ AI)
* **Legacy:** ë‹¨ìˆœ í…ìŠ¤íŠ¸ ê²€ìƒ‰(Simple RAG)ì´ë‚˜ í‚¤ì›Œë“œ ë§¤ì¹­.
* **Evolution:**
    * **GraphRAG:** ê¸°ì—… ì§€ë°°êµ¬ì¡°, ê³µê¸‰ë§ ë“± ë³µì¡í•œ ê´€ê³„ë¥¼ **ì§€ì‹ ê·¸ë˜í”„(Knowledge Graph)**ë¡œ ì‹œê°í™”í•˜ê³  ì¶”ë¡ .
    * **Multimodal Analysis:** ì¬ë¬´ì œí‘œ(í…ìŠ¤íŠ¸)ì™€ ì°¨íŠ¸(ì´ë¯¸ì§€)ë¥¼ ë™ì‹œì— ì´í•´í•˜ëŠ” ë©€í‹°ëª¨ë‹¬ ëª¨ë¸ ì—°êµ¬.

## ğŸ—ï¸ System Architecture

ì´ í”„ë¡œì íŠ¸ëŠ” **Stateful Multi-Agent Architecture**ë¥¼ ì±„íƒí•˜ì—¬, ì—ì´ì „íŠ¸ ê°„ì˜ ë©”ì‹œì§€ íë¦„ê³¼ ìƒíƒœ(State)ë¥¼ ì—„ê²©í•˜ê²Œ ê´€ë¦¬í•©ë‹ˆë‹¤.

```mermaid
graph TD
    User((User)) -->|Input Ticker| Supervisor[ğŸ•µï¸ Supervisor Agent]
    
    subgraph "Agentic Workflow (LangGraph)"
        Supervisor -->|Route| Chart[ğŸ“ˆ Chart Analyst\n(GPT-4o Vision)]
        Supervisor -->|Route| Knowledge[ğŸ•¸ï¸ Knowledge Analyst\n(Neo4j GraphRAG)]
        Supervisor -->|Route| Quant[ğŸ§® Quant Analyst\n(Technical Indicators)]
        
        Chart -->|Analysis| Supervisor
        Knowledge -->|Insight| Supervisor
        Quant -->|Metrics| Supervisor
    end
    
    Supervisor -->|Final Decision| User

```

## ğŸ“‚ Lab Structure (ì˜ˆì •)

ì´ ë ˆí¬ì§€í† ë¦¬ëŠ” ì£¼ì œë³„ ì‹¤í—˜(Experiment) ë‹¨ìœ„ë¡œ êµ¬ì„±ë  ì˜ˆì •ì…ë‹ˆë‹¤.

```bash
Neural-Fusion-Lab/
â”œâ”€â”€ ğŸ“‚ data/                  # Generated charts & Raw financial data
â”œâ”€â”€ ğŸ“‚ modules/               # Core Logic Modules
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agents.py             # LangGraph Nodes & Supervisor Logic
â”‚   â”œâ”€â”€ multimodal.py         # VLM Engine (Image Encoding & Prompting)
â”‚   â”œâ”€â”€ graph_rag.py          # Neo4j Connector & Cypher Query Engine
â”‚   â””â”€â”€ tools.py              # Market Data Fetcher (yfinance wrapper)
â”œâ”€â”€ ğŸ“‚ notebooks/             # EDA & Prototype Experiments
â”œâ”€â”€ main.py                   # Entry Point (Graph Compilation & Execution)
â”œâ”€â”€ config.yaml               # Model Configs & Hyperparameters
â”œâ”€â”€ requirements.txt          # Python Dependencies
â””â”€â”€ README.md                 # Project Documentation
```

## ğŸš€ Key Features & Implementation

### 1. ğŸ‘ï¸ Multimodal Technical Analysis (`modules/multimodal.py`)
* **Dynamic Visualization:** `matplotlib`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ìœ¼ë¡œ ì£¼ê°€ ì°¨íŠ¸(SMA, Bollinger Bands í¬í•¨)ë¥¼ ìƒì„±.
* **Vision AI:** ìƒì„±ëœ ì°¨íŠ¸ë¥¼ ì´ë¯¸ì§€ë¡œ ì¸ì½”ë”©í•˜ì—¬ **GPT-4o(VLM)**ì— ì£¼ì…. ë‹¨ìˆœ ìˆ˜ì¹˜ë¡œ íŒŒì•…í•˜ê¸° í˜ë“  ì‹œê°ì  íŒ¨í„´(Head & Shoulders, Wedge ë“±)ì„ ë¶„ì„.

### 2. ğŸ•¸ï¸ Knowledge Graph RAG (`modules/graph_rag.py`)
* **Neo4j Integration:** ê¸°ì—… ê°„ ê´€ê³„(ì§€ë¶„ êµ¬ì¡°, ê³µê¸‰ë§, ê²½ìŸì‚¬)ë¥¼ ì €ì¥í•œ ê·¸ë˜í”„ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ë™.
* **Supply Chain Risk:** ë‹¨ìˆœ í…ìŠ¤íŠ¸ ë‰´ìŠ¤ê°€ ì•„ë‹Œ, ì—°ê²°ëœ ë…¸ë“œ(Node)ë¥¼ íƒìƒ‰í•˜ì—¬ 2ì°¨, 3ì°¨ íŒŒê¸‰ íš¨ê³¼(Ripple Effect)ë¥¼ ì¶”ë¡ .

### 3. ğŸ¤– Orchestration with LangGraph (`modules/agents.py`)
* **State Management:** `TypedDict`ë¥¼ í™œìš©í•˜ì—¬ ì—ì´ì „íŠ¸ ê°„ ê³µìœ  ë©”ëª¨ë¦¬(Context) ê´€ë¦¬.
* **Router Logic:** ì‘ì—…ì˜ ì¢…ë¥˜ì— ë”°ë¼ ì í•©í•œ ì—ì´ì „íŠ¸ë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ì·¨í•©í•˜ëŠ” ì¤‘ì•™ ì œì–´ êµ¬ì¡°.

## ğŸ’» Getting Started

### Prerequisites
* Python 3.10+
* Neo4j Database (Local or AuraDB)
* OpenAI API Key

### Installation

1.  **Clone the repository**
    ```bash
    git clone [https://github.com/your-username/neural-fusion-lab.git](https://github.com/your-username/neural-fusion-lab.git)
    cd neural-fusion-lab
    ```

2.  **Install dependencies**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Configuration**
    * `.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  API í‚¤ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        ```ini
        OPENAI_API_KEY=sk-proj-...
        NEO4J_URI=bolt://localhost:7687
        NEO4J_USER=neo4j
        NEO4J_PASSWORD=your_password
        ```
    * `config.yaml`ì—ì„œ ëª¨ë¸ ë²„ì „ ë° íŒŒë¼ë¯¸í„°ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Usage
```bash
```
python main.py ì‹¤í–‰ ì‹œ main.pyì— ì„¤ì •ëœ ì¢…ëª©(ì˜ˆ: NVDA)ì— ëŒ€í•´ ë¶„ì„ì„ ì‹œì‘í•˜ë©°, data/ í´ë”ì— ì°¨íŠ¸ ì´ë¯¸ì§€ê°€ ìƒì„±ë˜ê³  í„°ë¯¸ë„ì— ìµœì¢… ë¶„ì„ ë¦¬í¬íŠ¸ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.

## ğŸ”® Future Research (Roadmap)

ì´ í”„ë¡œì íŠ¸ëŠ” ì§€ì†ì ìœ¼ë¡œ ê³ ë„í™”ë  ì˜ˆì •ì…ë‹ˆë‹¤.

* [x] **Phase 1 (Completed):** Multi-Agent System êµ¬ì¶• ë° Multimodal/GraphRAG ì—°ë™.
* [ ] **Phase 2 (In Progress):**
    * **Fine-tuning LLaVA:** ê¸ˆìœµ ì°¨íŠ¸ íŠ¹í™” Vision Model íŒŒì¸íŠœë‹.
    * **Text-to-Cypher:** ìì—°ì–´ ì§ˆì˜ë¥¼ ì •êµí•œ ê·¸ë˜í”„ ì¿¼ë¦¬ë¡œ ë³€í™˜í•˜ëŠ” ëª¨ë¸ í•™ìŠµ.
* [ ] **Phase 3 (Planned):**
    * **Deep Hedging (PPO):** ê°•í™”í•™ìŠµ ê¸°ë°˜ì˜ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™” ëª¨ë“ˆ íƒ‘ì¬.
    * **Auto-Backtest:** ì—ì´ì „íŠ¸ê°€ ì œì•ˆí•œ ì „ëµì„ ì¦‰ì‹œ ê²€ì¦í•˜ëŠ” ë°±í…ŒìŠ¤íŒ… ì—”ì§„ ì—°ë™.

## ğŸ› ï¸ Tech Stack & Tools

* **Core AI:** PyTorch, Stable-Baselines3, Hugging Face Transformers
* **LLM & Agents:** LangChain, LangGraph, LlamaIndex
* **Database & Graph:** Neo4j, Vector DB (Chroma/FAISS)
* **Finance:** yfinance, TA-Lib, QuantLib

---

### ğŸ‘¨â€ğŸ’» Maintainer

* **Jae Yeon Park**
* M.S. in Mathematical Sciences (Financial Mathematics)
* Focus: DRL in Finance, Time-Series Analysis, Agentic AI

---

*Disclaimer: This repository is for research and educational purposes. Not financial advice.*
